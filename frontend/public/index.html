<!-- author: milena -->
<!doctype html>
<html lang="en">
  <head>
	<link rel="icon" href="/favicon.ico" />
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <title>ft_transcendence</title>
    <!-- Tailwind CDN (dev convenience) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Canvas Styles -->
    <style>
        #gameCanvas {
            width: 100%;
            height: 100%;
            object-fit: contain;
            image-rendering: crisp-edges;
        }

        #gameContainer {
            max-height: calc(100vh - 150px);
        }

        #gameContainer canvas {
          max-height: calc(100% - 60px);
        }
    </style>
  </head>
  <body class="min-h-screen bg-gradient-to-br from-gray-900 to-black flex flex-col justify-between">
    <!-- Language switcher mount point -->
    <div data-lang-switcher></div>

    <!-- AUTH NAVBAR (shown by default) -->
    <nav id="auth-navbar" class="header flex flex-wrap justify-between items-center text-white px-5 py-0.25 shadow-lg bg-gradient-to-br from-[#2c3e50] to-[#3498db]">
        <h1 class="text-xl text-emerald-400 py-2">ft_transcendence</h1>
        <ul class="nav-bar-right flex gap-12 items-center">
            <li>
                <button class="hover:text-emerald-400 transition-colors" data-lang-switcher></button>
            </li>
        </ul>
    </nav>

    <!-- HEADER / NAVBAR (hidden by default, shown after login) -->
    <nav id="navbar" class="hidden header flex flex-wrap justify-between items-center text-white px-5 py-0.25 shadow-lg bg-gradient-to-br from-[#2c3e50] to-[#3498db]">
        <ul class="nav-bar-left flex gap-12">
            <li class="nav-item"><a href="#profile" class="hover:text-emerald-400 transition-colors" data-i18n="navbarDom.profile">Profile</a></li>
            <li class="nav-item"><a href="#game" class="hover:text-emerald-400 transition-colors" data-i18n="navbarDom.game">Game</a></li>
            <li class="nav-item"><a href="#friends" class="hover:text-emerald-400 transition-colors" data-i18n="navbarDom.friends">Friends</a></li>
            <li class="nav-item"><a href="#chat" class="hover:text-emerald-400 transition-colors" data-i18n="navbarDom.chat">Chat</a></li>
        </ul>
        <h1 class="text-xl text-emerald-400">ft_transcendence</h1>
        <ul class="nav-bar-right flex gap-12 items-center">
            <li>
                <button class="hover:text-emerald-400 transition-colors" data-lang-switcher></button>
            </li>
            <li class="relative group">
                <button class="hover:text-emerald-400 transition-colors" data-i18n="navbarDom.settings">Settings</button>
                <div class="absolute left-0 mt-0 w-48 bg-gray-800 rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 z-50">
                    <a href="#settings/edit-username" class="block px-4 py-2 text-white hover:bg-emerald-400 hover:text-black rounded-t-lg transition-colors" data-i18n="navbarDom.edit_username">Edit Username</a>
                    <a href="#settings/change-password" class="block px-4 py-2 text-white hover:bg-emerald-400 hover:text-black transition-colors" data-i18n="navbarDom.change_password">Change Password</a>
                    <a href="#settings/change-email" class="block px-4 py-2 text-white hover:bg-emerald-400 hover:text-black transition-colors" data-i18n="navbarDom.change_email">Change Email</a>
                    <a href="#settings/upload-avatar" class="block px-4 py-2 text-white hover:bg-emerald-400 hover:text-black transition-colors" data-i18n="navbarDom.change_avatar">Upload Avatar</a>
                    <div class="block px-4 py-2 rounded-b-lg transition-colors flex items-center gap-3">
                      <span class="text-white" data-i18n="navbarDom.two_fa">2-Factor Auth</span>
                      <button id="dropdown-toggle-2fa" type="button" class="relative inline-flex items-center h-6 w-12 rounded-full transition-colors focus:outline-none bg-gray-400" aria-pressed="false">
                        <span class="sr-only">Enable 2FA</span>
                        <span class="inline-block h-5 w-5 transform bg-white rounded-full shadow transition-transform translate-x-0"></span>
                      </button>
                    </div>
                </div>
            </li>
            <button id="logoutBtn" class="bg-gradient-to-r from-green-400 to-green-500 hover:bg-gradient-to-r hover:from-green-500 hover:to-green-400 border-none rounded-3xl px-4 py-1.5 my-1 text-white font-bold cursor-pointer transition-all duration-300 shadow-md hover:-translate-y-1 hover:shadow-lg" data-i18n="navbarDom.logout">
                Logout
            </button>
        </ul>
    </nav>

    <!-- SETTINGS: EDIT USERNAME SECTION (hidden by default) -->
    <section id="settings-edit-username" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/60">
      <div class="bg-gradient-to-br from-[#2c3e50] to-[#3498db] rounded-xl shadow-2xl p-8 w-full max-w-md border-2 border-emerald-400 flex flex-col items-center">
        <h2 class="text-2xl font-bold text-emerald-400 mb-4">Edit Username</h2>
        <form id="edit-username-form" class="w-full flex flex-col gap-4">
          <label for="new-username" class="text-emerald-200 text-sm">New Username</label>
          <input id="new-username" name="new-username" type="text" class="w-full px-3 py-2 border border-emerald-400 rounded-md bg-gray-900 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-emerald-400" placeholder="Enter new username" required />
          <div id="edit-username-error" class="text-red-400 text-sm min-h-[1.5em]"></div>
          <div class="flex gap-4 justify-end">
            <button type="button" id="cancel-edit-username" class="px-4 py-2 rounded bg-gray-500 text-white hover:bg-gray-600 transition">Cancel</button>
            <button type="submit" class="px-4 py-2 rounded bg-emerald-400 text-black font-semibold hover:bg-emerald-300 transition">Save</button>
          </div>
        </form>
      </div>
    </section>

    <!-- SETTINGS: EDIT EMAIL SECTION (hidden by default) -->
    <section id="settings-change-email" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/60">
      <div class="bg-gradient-to-br from-[#2c3e50] to-[#3498db] rounded-xl shadow-2xl p-8 w-full max-w-md border-2 border-emerald-400 flex flex-col items-center">
        <h2 class="text-2xl font-bold text-emerald-400 mb-4">Change Email</h2>
        <form id="change-email-form" class="w-full flex flex-col gap-4">
          <label for="new-email" class="text-emerald-200 text-sm">New Email</label>
          <input id="new-email" name="new-email" type="text" class="w-full px-3 py-2 border border-emerald-400 rounded-md bg-gray-900 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-emerald-400" placeholder="Enter new email" required />
          <div id="change-email-error" class="text-red-400 text-sm min-h-[1.5em]"></div>
          <div class="flex gap-4 justify-end">
            <button type="button" id="cancel-change-email" class="px-4 py-2 rounded bg-gray-500 text-white hover:bg-gray-600 transition">Cancel</button>
            <button type="submit" class="px-4 py-2 rounded bg-emerald-400 text-black font-semibold hover:bg-emerald-300 transition">Save</button>
          </div>
        </form>
      </div>
    </section>

    <!-- SETTINGS: CHANGE PASSWORD SECTION (hidden by default) -->
    <section id="settings-change-password" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/60">
      <div class="bg-gradient-to-br from-[#2c3e50] to-[#3498db] rounded-xl shadow-2xl p-8 w-full max-w-md border-2 border-emerald-400 flex flex-col items-center">
        <h2 class="text-2xl font-bold text-emerald-400 mb-4">Change Password</h2>
        <form id="change-password-form" class="w-full flex flex-col gap-4">
          <label for="old-password" class="text-emerald-200 text-sm">Old Password</label>
          <input id="old-password" name="old-password" type="password" class="w-full px-3 py-2 border border-emerald-400 rounded-md bg-gray-900 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-emerald-400" placeholder="Enter old password" required />
          <label for="new-password" class="text-emerald-200 text-sm">New Password</label>
          <input id="new-password" name="new-password" type="password" class="w-full px-3 py-2 border border-emerald-400 rounded-md bg-gray-900 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-emerald-400" placeholder="Enter new password" required />
          <div id="change-password-error" class="text-red-400 text-sm min-h-[1.5em]"></div>
          <div class="flex gap-4 justify-end">
            <button type="button" id="cancel-change-password" class="px-4 py-2 rounded bg-gray-500 text-white hover:bg-gray-600 transition">Cancel</button>
            <button type="submit" class="px-4 py-2 rounded bg-emerald-400 text-black font-semibold hover:bg-emerald-300 transition">Change</button>
          </div>
        </form>
      </div>
    </section>

    <!-- MAIN CONTENT AREA -->
    <div id="content" class="flex-1 flex flex-col justify-start items-center max-w-[1960px] mx-auto w-full">

      <!-- LOGIN/REGISTER SECTION (shown by default) -->
      <section id="auth-section" class="w-full h-full flex flex-col items-center justify-center">
        <div class="auth-container w-[320px] bg-gradient-to-br from-[#2c3e50] to-[#3498db] border border-emerald-400 rounded-xl shadow-lg p-6 m-16 space-y-4 text-white">
          <h1 class="text-xl font-semibold text-emerald-400 text-center" data-i18n="authDom.title">Login</h1>

          <label for="user" class="block text-xs text-emerald-200" data-i18n="authDom.username">Username</label>
          <input id="user" autocomplete="username" class="w-full px-3 py-2 border border-emerald-400 rounded-md bg-gray-900 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-emerald-400" />

          <label for="email" class="block text-xs text-emerald-200" data-i18n="authDom.email">Email</label>
          <input id="email" type="email" autocomplete="email" class="w-full px-3 py-2 border border-emerald-400 rounded-md bg-gray-900 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-emerald-400" />

          <label for="pass" class="block text-xs text-emerald-200" data-i18n="authDom.password">Password</label>
          <input id="pass" type="password" autocomplete="current-password" class="w-full px-3 py-2 border border-emerald-400 rounded-md bg-gray-900 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-emerald-400" />

          <button id="loginBtn" class="w-full mt-2 px-3 py-2 rounded-md border border-emerald-400 bg-emerald-400 text-black font-semibold hover:bg-emerald-300 hover:border-emerald-300 active:bg-emerald-500 transition-all" data-i18n="authDom.loginBtn">Login</button>

          <button id="registerBtn" class="w-full mt-1 px-3 py-2 rounded-md border border-emerald-400 text-emerald-400 hover:bg-emerald-400 hover:text-black transition-all" data-i18n="authDom.registerBtn">Register</button>

          <!-- New: pretendLogin: delete later-->
          <button id="pretendLoginBtn" class="w-full mt-1 px-3 py-2 rounded-md border border-green-400 bg-green-400 text-black font-semibold hover:bg-green-300 hover:border-green-300 active:bg-green-500 transition-all" data-i18n="authDom.pretendLoginBtn">pretendLogin → landing</button>
        </div>
      </section>


        <!-- PROFILE SECTION (hidden by default) -->
        <section id="profile-section" class="hidden w-full">
        <div class="profile flex justify-around items-center w-full bg-gradient-to-r from-[#40e5c9] to-[#2ecc71] p-4 shadow-lg flex-wrap">
          <div class="avatar-name flex flex-col items-center">
            <img id="profile-avatar" src="" alt="Avatar image" class="h-40 w-auto rounded-full border-2 border-white/20 shadow-lg m-4">
            <h2 class="text-white font-bold text-lg" id="username"></h2>
            <!-- Avatar upload button -->
            <button id="open-upload-avatar" class="mt-2 px-4 py-2 rounded bg-emerald-400 text-black font-semibold hover:bg-emerald-300 transition">Upload Avatar</button>
          </div>

          <div class="stats flex flex-col justify-between items-center">
            <h3 class="text-black font-bold text-lg">Statistics</h3>
            <div class="text-rectangle flex justify-between gap-12 text-black shadow-xl rounded-3xl p-4 backdrop-blur-sm font-[Brush_Script_MT]">
              <ul class="match-stats pl-5">
                <h4 class="font-bold">Matches</h4>
                <li>Wins: <span  id="match-wins"></span></li>
                <li>Losses: <span id="match-losses"></span></li>
                <li>Winning rate: <span id="match-winning-rate"></span> </li>
              </ul>
              <ul class="tournament-stats">
                <h4 class="font-bold">Tournaments</h4>
                <li>Wins: <span id="tourn-wins"></span></li>
                <li>Losses: <span  id="tourn-losses"></span></li>
                <li>Winning rate: <span id="tourn-winning-rate"></span> </li>
              </ul>
            </div>
          </div>
        </div>

        <div class="match-history w-2/3 flex flex-col justify-center items-center text-emerald-400 p-4 m-auto font-[Brush_Script_MT]">
          <h3 class="mb-4 font-bold">Match History</h3>
          <ul class="text-rectangle flex flex-col items-start w-full">
            <!-- Match items will be rendered here by JS -->
            <ul id="match-history-list" class="w-full"></ul>
          </ul>
        </div>
        </section>

        <!-- SETTINGS: UPLOAD AVATAR SECTION (hidden by default) -->
        <section id="settings-upload-avatar" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/60">
        <div class="bg-gradient-to-br from-[#2c3e50] to-[#3498db] rounded-xl shadow-2xl p-8 w-full max-w-md border-2 border-emerald-400 flex flex-col items-center">
          <h2 class="text-2xl font-bold text-emerald-400 mb-4">Upload Avatar</h2>
          <form id="upload-avatar-form" class="w-full flex flex-col gap-4" enctype="multipart/form-data">
          <label for="avatar-file" class="text-emerald-200 text-sm">Choose an image</label>
          <input id="avatar-file" name="avatar" type="file" accept="image/*" class="w-full px-3 py-2 border border-emerald-400 rounded-md bg-gray-900 text-white focus:outline-none focus:ring-2 focus:ring-emerald-400" required />
          <div id="upload-avatar-error" class="text-red-400 text-sm min-h-[1.5em]"> </div>
          <div class="flex gap-4 justify-end">
            <button type="button" id="cancel-upload-avatar" class="px-4 py-2 rounded bg-gray-500 text-white hover:bg-gray-600 transition">Cancel</button>
            <button type="submit" class="px-4 py-2 rounded bg-emerald-400 text-black font-semibold hover:bg-emerald-300 transition">Upload</button>
          </div>
          </form>
        </div>
        </section>

      <!-- GAME SECTION (hidden by default) -->
      <section id="game-section" class="hidden w-full h-full flex flex-col items-center justify-center text-white">
        <!-- Edited by Matthias for testing:
        Game Mode Menu (direkt sichtbar) -->
        <div id="gameModeMenu" class="flex-column m-8">
          <h2 class="mb-8 text-4xl font-bold">Choose Game Mode</h2>
          <div class="flex gap-4">
            <button
              id="playLocalButton"
              class="bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-8 rounded-lg text-xl transition-all transform hover:scale-105">
              Play Local
            </button>
            <button
              id="playRemoteButton"
              class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-4 px-8 rounded-lg text-xl transition-all transform hover:scale-105">
              Play vs Player
            </button>
          </div>
        </div>
        <!-- Game Canvas (hidden initially) -->
        <div id="gameContainer" class="hidden w-full flex-1 flex flex-col items-center justify-start gap-4 p-4 pt-16">
          <canvas id="gameCanvas" class="max-w-full max-h-full"></canvas>
          <button
            id="exitGameButton"
            class="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-8 rounded-lg transition-colors">
            Exit Game
          </button>
        </div>
      </section>

      <!-- FRIENDS SECTION (hidden by default) -->
      <section id="friends-section" class="hidden w-full h-full flex flex-col items-center justify-center text-white text-lg">
        <div class="friends flex flex-col justify-between m-8 gap-8">
          <!-- Search Section -->
          <div class="searchbar flex flex-wrap justify-center items-center gap-4">
              <input id="searchInput" name="to-search" type="text" placeholder="Search nickname..." class="border border-gray-400 p-2 rounded text-black">
              <button id="search-button" class="rounded px-3 py-1 bg-emerald-300 hover:bg-emerald-500 text-black">search</button>
          </div>
          <!-- Search Result Display (shown when a user is found) -->
          <div id="search-result-user" class="hidden flex flex-col items-center gap-2 mt-2">
            <div class="flex items-center gap-3">
              <img id="search-result-avatar" src="" alt="Avatar image" class="avatar h-8 w-8 rounded-full border border-emerald-400">
              <span id="search-result-nickname" class="font-semibold text-emerald-300"></span>
            </div>
            <button id="add-friend-btn" class="bg-blue-500 text-white px-3 py-1 rounded">Send Friend Request</button>
          </div>
          <div id="search-result-message" class="text-red-400 text-center"></div>

          <!-- Friends Block -->
          <div class="friends-block flex flex-wrap justify-center gap-32 items-start">
          <div class="flex flex-col border border-emerald-400 rounded-xl">
            <h1 class="text-black font-bold m-4 text-emerald-400">Your Friends</h1>
            <ul id="friends-list" class="flex flex-col m-4">
              <!-- Friend items rendered by JS -->
            </ul>
          </div>
          <div class="flex flex-col border border-emerald-400 rounded-xl">
            <h2 class="text-black font-bold m-4 text-emerald-400">Friend Requests</h2>
            <ul id="requests-list" class="flex flex-col m-4">
              <!-- Request items rendered by JS -->
            </ul>
          </div>
          </div>
      </div>
      </section>

	<!-- CHAT SECTION (hidden by default) -->
	<section id="chat-section" class="hidden w-full h-full flex text-white">

	<aside class="w-1/3 max-w-sm border-r border-white/10 overflow-y-auto">
		<!-- LEFT: CHAT SEARCH -->
		<div class="p-3 border-b border-white/10 sticky top-0 bg-black/80 backdrop-blur">
			<input
			id="chat-search"
			type="text"
			placeholder="Search chats..."
			class="w-full bg-white/10 rounded px-3 py-2 outline-none text-sm"
			/>
		</div>
		<!-- LEFT: CHAT LIST -->
		<ul id="chat-list" class="divide-y divide-white/10"></ul>
	</aside>

	<!-- RIGHT: ACTIVE CHAT -->
	<div class="flex flex-col flex-1">
		<!-- Chat header -->
		<header id="chat-header" class="p-4 border-b border-white/10 font-semibold">
		Select a chat
		</header>

		<div
		id="chat-messages"
		class="flex-1 overflow-y-auto p-4 space-y-3"
		></div>

		<form id="chat-form" class="flex gap-2">
		<input
			id="chat-input"
			type="text"
			placeholder="Type a message…"
			class="flex-1 bg-white/10 rounded px-3 py-2 outline-none"
		/>
		<button type="submit" class="bg-blue-600 px-4 py-2 rounded">
			Send
		</button>
		</form>
		</footer>
	</div>
	</section>
	<!-- CHAT SECTION END-->

      <!-- NOTFOUND SECTION (hidden by default) -->
      <section id="notfound-section" class="hidden w-full h-full flex items-center justify-center text-white">
        <div class="text-center">
          <h2 class="mb-4 text-3xl font-bold">Page Not Found</h2>
          <p class="mb-4">The page you requested doesn't exist.</p>
          <button id="notfoundHomeBtn" class="bg-emerald-400 text-black px-4 py-2 rounded">Go to Home</button>
        </div>
      </section>

    </div>

    <!-- FOOTER (shown by default) -->
    <footer id="footer" class="flex justify-around px-2.5 py-1 bg-gradient-to-r from-[#2c3e50] to-[#3498db] shadow-inner text-white">
      A project made by dhuss, merdal, isemin, maustel, mgering
    </footer>

    <!-- i18n / language init for this page --> <!-- requires <div data-lang-switcher></div> -->
    <script type="module" src="/dist/components/languages/init.js"></script>

    <!-- button logic -->
    <script type="module" src="/dist/components/auth/loginButton.js"></script>
    <script type="module" src="/dist/components/auth/registerButton.js"></script>
    <script type="module" src="/dist/components/auth/pretendLoginButton.js"></script> <!-- Delete later -->

    <!-- load gameManager.js-->
    <script type="module" src="/dist/game_components/gameManager.js"></script>

    <!-- profile logic -->
    <script type="module" src="/dist/components/profile/profile.js"></script>

    <!-- chat component -->
    <script type="module" src="/dist/components/messaging/chatPage.js"></script>

    <!-- settings -->
    <script type="module" src="/dist/components/settings/editUsername.js"></script>
    <script type="module" src="/dist/components/settings/uploadAvatar.js"></script>
    <script type="module" src="/dist/components/settings/twoFactorAuth.js"></script>
    <script type="module" src="/dist/components/settings/changePassword.js"></script>
    <script type="module" src="/dist/components/settings/changeEmail.js"></script>

    <!-- SPA Router -->
    <script type="module" src="/dist/common/router.js"></script>

    <!-- Friends page logic -->
    <script type="module" src="/dist/components/friends/searchButton.js"></script>
    <script type="module" src="/dist/components/friends/requestsList.js"></script>
    <script type="module" src="/dist/components/friends/friendsContent.js"></script>
  </body>
</html>
